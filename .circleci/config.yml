setup: true
version: 2.1
orbs:
  continuation: circleci/continuation@0.2.0
workflows:
  setup:
    jobs:
      - continuation/continue:
          configuration_path: ".circleci/main.yml"
          parameters: |
            /home/circleci/paramsPR.json
            /home/circleci/params.json
          pre-steps:
            - run:
                command: |
                  if [ -z "${CIRCLE_PULL_REQUEST##*/}" ]
                  then
                    IS_PR=false
                  else
                    IS_PR=true
                  fi
                  echo '{ "is_pr": '$IS_PR' }' >> /home/circleci/paramsPR.json
                
                  if [ -z "{$CIRCLE_BRANCH <> "main"}" ]
                    then
                      IS_MAIN=true
                    else
                      IS_MAIN=false
                    fi
                    echo '{ "is_main": '$IS_MAIN' }' >> /home/circleci/params.json